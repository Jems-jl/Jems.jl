<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StellarEvolution · Jems.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://orlox.github.io/Jems.jl/Evolution/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Jems.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Jems.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>StellarEvolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>StellarEvolution</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/orlox/Jems.jl/blob/main/docs/src/Evolution.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="StellarEvolution"><a class="docs-heading-anchor" href="#StellarEvolution">StellarEvolution</a><a id="StellarEvolution-1"></a><a class="docs-heading-anchor-permalink" href="#StellarEvolution" title="Permalink"></a></h1><p>The StellarEvolution module contains the basic tools needed to combine all other modules to perform stellar evolution. It allows a fully customizable definition of the equations that are solved together with their boundary conditions.</p><ul><li><a href="#StellarEvolution">StellarEvolution</a></li><li class="no-marker"><ul><li><a href="#StellarModel.jl">StellarModel.jl</a></li><li><a href="#Options.jl">Options.jl</a></li><li><a href="#Equations.jl">Equations.jl</a></li><li><a href="#Solver.jl">Solver.jl</a></li><li><a href="#EvolutionLoop.jl">EvolutionLoop.jl</a></li><li><a href="#InitialCondition.jl">InitialCondition.jl</a></li><li><a href="#IO.jl">IO.jl</a></li></ul></li></ul><p>A model is initialized by specifying its independent variables and equations. The following creates a model with a basic ideal gas EOS and electron scattering opacity, which is then initialized using an n=1 polytrope of 1<span>$M_\odot$</span> and <span>$100R_\odot$</span>. Options for a simulation can be specified with a <a href="https://toml.io/en/">toml</a> file. Below we directly create a file with custom options and then load it up into the model. After setting everything up the simulation is run.</p><pre><code class="language-julia hljs">using Jems.Evolution
using Jems.EOS
using Jems.Opacity
using Jems.Constants

nvars = 6
nspecies = 2
varnames = [:lnP, :lnT, :lnr, :lum, :H1, :He4]
structure_equations=[Evolution.equationHSE, Evolution.equationT,
                        Evolution.equationContinuity, Evolution.equationLuminosity,
                        Evolution.equationH1, Evolution.equationHe4]
nz = 1000
eos = EOS.IdealEOS(false)
opacity = Opacity.SimpleElectronScatteringOpacity()
sm = StellarModel(varnames, structure_equations, nvars, nspecies, nz, eos, opacity)

#Initialize the model as n=1 polytrope with an initial timestep of 10 years
Evolution.n1_polytrope_initial_condition(sm, MSUN, 100*RSUN; initial_dt=10*SECYEAR)

#Load custom options
open(&quot;options.toml&quot;,&quot;w&quot;) do file
    write(file,&quot;&quot;&quot;
            [termination]
            max_model_number = 300
&quot;&quot;&quot;)
end
Evolution.set_options!(sm.opt, &quot;options.toml&quot;)

#run simulation
#Evolution.do_evolution_loop(sm)</code></pre><p>The results of the simulation are provided in HDF5 format.</p><h2 id="StellarModel.jl"><a class="docs-heading-anchor" href="#StellarModel.jl">StellarModel.jl</a><a id="StellarModel.jl-1"></a><a class="docs-heading-anchor-permalink" href="#StellarModel.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.StellarModel" href="#Jems.Evolution.StellarModel"><code>Jems.Evolution.StellarModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct StellarModel</code></pre><p>An evolutionary model for a star, containing information about the star&#39;s current state, as well as the independent  variables of the model and its equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/StellarModel.jl#L35-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.StellarModel-Tuple{Vector{Symbol}, Vector{Function}, Int64, Int64, Int64, Jems.EOS.AbstractEOS, Jems.Opacity.AbstractOpacity}" href="#Jems.Evolution.StellarModel-Tuple{Vector{Symbol}, Vector{Function}, Int64, Int64, Int64, Jems.EOS.AbstractEOS, Jems.Opacity.AbstractOpacity}"><code>Jems.Evolution.StellarModel</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">StellarModel(varnames::Vector{Symbol}, structure_equations::Vector{Function}, nvars::Int, 
nspecies::Int, nz::Int, eos::AbstractEOS, opacity::AbstractOpacity)</code></pre><p>Constructor for a <code>StellarModel</code> instance, using <code>varnames</code> for the independent variables, functions of the  <code>structure_equations</code> to be solved, number of independent variables <code>nvars</code>, number of species in the network <code>nspecies</code> number of zones in the model <code>nz</code> and an iterface to the EOS and Opacity laws.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/StellarModel.jl#L86-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.StellarStepInfo" href="#Jems.Evolution.StellarStepInfo"><code>Jems.Evolution.StellarStepInfo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct StellarStepInfo</code></pre><p>Information used for a simulation step. A single stellar model can have three different objects of type StellarStepInfo, containing information from the previous step, information right before the Newton solver, and information after the Newton solver has completed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/StellarModel.jl#L5-L11">source</a></section></article><h2 id="Options.jl"><a class="docs-heading-anchor" href="#Options.jl">Options.jl</a><a id="Options.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Options.jl" title="Permalink"></a></h2><h2 id="Equations.jl"><a class="docs-heading-anchor" href="#Equations.jl">Equations.jl</a><a id="Equations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Equations.jl" title="Permalink"></a></h2><h2 id="Solver.jl"><a class="docs-heading-anchor" href="#Solver.jl">Solver.jl</a><a id="Solver.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Solver.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.eval_cell_eqs-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Vector{&lt;:TT}}} where TT&lt;:Real" href="#Jems.Evolution.eval_cell_eqs-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Vector{&lt;:TT}}} where TT&lt;:Real"><code>Jems.Evolution.eval_cell_eqs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eval_cell_eqs(sm::StellarModel, k::Int, ind_vars_view::Vector{&lt;:TT}) where{TT&lt;:Real}</code></pre><p>Evaluates the stellar structure equations of the stellar model, <code>sm</code>, at cell <code>k</code>, given the view of the independent variables, <code>ind_vars_view</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/Solver.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.eval_eqs!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.eval_eqs!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.eval_eqs!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eval_eqs(sm::StellarModel)</code></pre><p>Evaluates the stellar structure equations of the stellar model, <code>sm</code>, for all cells.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/Solver.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.eval_jacobian!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.eval_jacobian!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.eval_jacobian!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eval_jacobian!(sm::StellarModel)</code></pre><p>Evaluates the whole Jacobian matrix of the given StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/Solver.jl#L131-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.eval_jacobian_row!-Tuple{Jems.Evolution.StellarModel, Int64}" href="#Jems.Evolution.eval_jacobian_row!-Tuple{Jems.Evolution.StellarModel, Int64}"><code>Jems.Evolution.eval_jacobian_row!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eval_jacobian_row!(sm::StellarModel, k::int)</code></pre><p>Evaluates row <code>k</code> of the Jacobian matrix of the given StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/Solver.jl#L85-L89">source</a></section></article><h2 id="EvolutionLoop.jl"><a class="docs-heading-anchor" href="#EvolutionLoop.jl">EvolutionLoop.jl</a><a id="EvolutionLoop.jl-1"></a><a class="docs-heading-anchor-permalink" href="#EvolutionLoop.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.cycle_step_info!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.cycle_step_info!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.cycle_step_info!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cycle_step_info!(sm::StellarModel)</code></pre><p>Moves the model info of the StellarModel <code>sm</code> over one state: start step info -&gt; end step info -&gt; previous step info -&gt; start step info</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/EvolutionLoop.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.do_evolution_loop-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.do_evolution_loop-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.do_evolution_loop</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">do_evolution_loop(sm::StellarModel)</code></pre><p>Performs the main evolutionary loop of the input StellarModel <code>sm</code>. It continues taking steps until one of the termination criteria is reached (defined in sm.opt.termination)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/EvolutionLoop.jl#L102-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.get_dt_next-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.get_dt_next-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.get_dt_next</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_dt_next(sm::StellarModel)</code></pre><p>Computes the timestep of the next evolutionary step to be taken by the StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/EvolutionLoop.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.set_end_step_info!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.set_end_step_info!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.set_end_step_info!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_end_step_info(sm::StellarModel)</code></pre><p>Sets the end step info (sm.esi) from current state of the StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/EvolutionLoop.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.set_start_step_info!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.set_start_step_info!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.set_start_step_info!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_start_step_info!(sm::StellarModel)</code></pre><p>Sets the start step info of the StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/EvolutionLoop.jl#L45-L49">source</a></section></article><h2 id="InitialCondition.jl"><a class="docs-heading-anchor" href="#InitialCondition.jl">InitialCondition.jl</a><a id="InitialCondition.jl-1"></a><a class="docs-heading-anchor-permalink" href="#InitialCondition.jl" title="Permalink"></a></h2><h2 id="IO.jl"><a class="docs-heading-anchor" href="#IO.jl">IO.jl</a><a id="IO.jl-1"></a><a class="docs-heading-anchor-permalink" href="#IO.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.history_get_ind_vars_edge_value-Tuple{Jems.Evolution.StellarModel, Symbol, Symbol}" href="#Jems.Evolution.history_get_ind_vars_edge_value-Tuple{Jems.Evolution.StellarModel, Symbol, Symbol}"><code>Jems.Evolution.history_get_ind_vars_edge_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">history_get_ind_vars_edge_value(sm::StellarModel, var_symbol::Symbol, edge::Symbol)</code></pre><p>Returns the value of the independent variable <code>var_symbol</code> at either the surface or the center of the StellarModel <code>sm</code>. <code>edge</code> can be either <code>:surface</code> or <code>:center</code>.    </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/IO.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.profile_get_ind_vars_value-Tuple{Jems.Evolution.StellarModel, Symbol, Int64}" href="#Jems.Evolution.profile_get_ind_vars_value-Tuple{Jems.Evolution.StellarModel, Symbol, Int64}"><code>Jems.Evolution.profile_get_ind_vars_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">profile_get_ind_vars_value(sm::StellarModel, var_symbol::Symbol, k::Int)</code></pre><p>Returns the value of the variable Symbol <code>var_symbol</code> at cell number <code>k</code> of the StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/016dca2c6eb3bc73beb69da1dc6c185b7bf1c250/src/Evolution/IO.jl#L47-L51">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 9 August 2023 12:32">Wednesday 9 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
