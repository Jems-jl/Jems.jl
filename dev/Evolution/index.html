<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Evolution · Jems.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://orlox.github.io/Jems.jl/Evolution/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Jems.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Jems.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../NuclearBurning/">NuclearBurning.jl</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../Chem/">Chem</a></li><li><a class="tocitem" href="../Constants/">Constants</a></li><li><a class="tocitem" href="../EOS/">EOS</a></li><li class="is-active"><a class="tocitem" href>Evolution</a><ul class="internal"><li><a class="tocitem" href="#StellarModel.jl"><span>StellarModel.jl</span></a></li><li><a class="tocitem" href="#Options.jl"><span>Options.jl</span></a></li><li><a class="tocitem" href="#Equations.jl"><span>Equations.jl</span></a></li><li><a class="tocitem" href="#Solver.jl"><span>Solver.jl</span></a></li><li><a class="tocitem" href="#EvolutionLoop.jl"><span>EvolutionLoop.jl</span></a></li><li><a class="tocitem" href="#InitialCondition.jl"><span>InitialCondition.jl</span></a></li><li><a class="tocitem" href="#IO.jl"><span>IO.jl</span></a></li></ul></li><li><a class="tocitem" href="../Opacity/">Opacity</a></li></ul></li><li><span class="tocitem">Developing</span><ul><li><a class="tocitem" href="../style/">Style Guide</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modules</a></li><li class="is-active"><a href>Evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Evolution</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/orlox/Jems.jl/blob/main/docs/src/Evolution.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Evolution"><a class="docs-heading-anchor" href="#Evolution">Evolution</a><a id="Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Evolution" title="Permalink"></a></h1><p>The Evolution module of Jems contains the basic tools needed to combine all other modules to perform stellar evolution. It allows a fully customizable definition of the equations that are solved together with their boundary conditions.</p><h2 id="StellarModel.jl"><a class="docs-heading-anchor" href="#StellarModel.jl">StellarModel.jl</a><a id="StellarModel.jl-1"></a><a class="docs-heading-anchor-permalink" href="#StellarModel.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.StellarModel" href="#Jems.Evolution.StellarModel"><code>Jems.Evolution.StellarModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct StellarModel{TN&lt;:Real,TD&lt;:Real,TEOS&lt;:EOS.AbstractEOS,TKAP&lt;:Opacity.AbstractOpacity}</code></pre><p>An evolutionary model for a star, containing information about the star&#39;s current state, as well as the independent variables of the model and its equations.</p><p>The struct has four parametric types, <code>TN</code> for &#39;normal&#39; numbers, <code>TD</code> for dual numbers used in automatic differentiation, <code>TEOS</code> for the type of EOS being used and <code>TKAP</code> for the type of opacity law being used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/StellarModel.jl#L67-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.StellarModel-Tuple{Vector{Symbol}, Vector{Function}, Int64, Int64, Int64, Jems.EOS.AbstractEOS, Jems.Opacity.AbstractOpacity}" href="#Jems.Evolution.StellarModel-Tuple{Vector{Symbol}, Vector{Function}, Int64, Int64, Int64, Jems.EOS.AbstractEOS, Jems.Opacity.AbstractOpacity}"><code>Jems.Evolution.StellarModel</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">StellarModel(varnames::Vector{Symbol}, structure_equations::Vector{Function},
             nvars::Int, nspecies::Int, nz::Int, eos::AbstractEOS, opacity::AbstractOpacity)</code></pre><p>Constructor for a <code>StellarModel</code> instance, using <code>varnames</code> for the independent variables, functions of the <code>structure_equations</code> to be solved, number of independent variables <code>nvars</code>, number of species in the network <code>nspecies</code> number of zones in the model <code>nz</code> and an iterface to the EOS and Opacity laws.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/StellarModel.jl#L132-L139">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.StellarStepInfo" href="#Jems.Evolution.StellarStepInfo"><code>Jems.Evolution.StellarStepInfo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct StellarStepInfo{TN&lt;:Real}</code></pre><p>Information used for a simulation step. A single stellar model can have three different objects of type StellarStepInfo, containing information from the previous step, information right before the Newton solver, and information after the Newton solver has completed.</p><p>The struct has one parametric type, TN to represent &#39;normal&#39; numbers. No fields here need to have dual numbers as these will not be used in automatic differentiation routines.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/StellarModel.jl#L31-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.TypeStableEquation" href="#Jems.Evolution.TypeStableEquation"><code>Jems.Evolution.TypeStableEquation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct TypeStableEquation{TS,TD&lt;:Real}</code></pre><p>Structure that wraps a stellar structure equation into a type stable object, using FunctionWrappers.jl. This requires that the stellar structure equations have the following signature:</p><pre><code class="nohighlight hljs">function structure_equation(::TS, ::Int,
                            ::Matrix{TD}, ::Matrix{TD}, ::Matrix{TD},
                            ::EOSResults{TD}, ::EOSResults{TD}, ::EOSResults{TD}
                            ::TD, ::TD, ::TD)::TD</code></pre><p>For typical usage, TS is the concrete type of StellarModel, and TD the type of dual number being used for automatic differentiation. The function must return an object of type TD, the result of the equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/StellarModel.jl#L7-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.init_diff_cache!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.init_diff_cache!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.init_diff_cache!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init_diff_cache!(sm::StellarModel)</code></pre><p>Initializes the diff<em>caches to the values of the independent variables, and sets ones in the correct spots where the dx</em>i^k/dx_i^k entries lie.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/StellarModel.jl#L227-L232">source</a></section></article><h2 id="Options.jl"><a class="docs-heading-anchor" href="#Options.jl">Options.jl</a><a id="Options.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Options.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.IOOptions" href="#Jems.Evolution.IOOptions"><code>Jems.Evolution.IOOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct IOOptions</code></pre><p>Substructure of Options containing controls relating to input/output of data</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Options.jl#L42-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.Options" href="#Jems.Evolution.Options"><code>Jems.Evolution.Options</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Options</code></pre><p>Structure containing tweakable controls of Jems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Options.jl#L67-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.SolverOptions" href="#Jems.Evolution.SolverOptions"><code>Jems.Evolution.SolverOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct SolverOptions</code></pre><p>Substructure of Options containing controls relating to the Newton solver</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Options.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.TerminationOptions" href="#Jems.Evolution.TerminationOptions"><code>Jems.Evolution.TerminationOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct TerminationOptions</code></pre><p>Substructure of Options containing controls relating to termination of the simulation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Options.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.TimestepOptions" href="#Jems.Evolution.TimestepOptions"><code>Jems.Evolution.TimestepOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct TimestepOptions</code></pre><p>Substructure of Options containing controls relating to timestepping</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Options.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.set_options!-Tuple{Jems.Evolution.Options, String}" href="#Jems.Evolution.set_options!-Tuple{Jems.Evolution.Options, String}"><code>Jems.Evolution.set_options!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_options!(opt::Options, toml_path::String)</code></pre><p>Sets the controls in <code>opt</code> to the values supplied in the TOML file <code>toml_path</code>, containing <code>key: value</code> pairs. Invalid keys are not allowed, and an Exception will be thrown.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Options.jl#L83-L88">source</a></section></article><h2 id="Equations.jl"><a class="docs-heading-anchor" href="#Equations.jl">Equations.jl</a><a id="Equations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Equations.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.equationContinuity-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real" href="#Jems.Evolution.equationContinuity-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>Jems.Evolution.equationContinuity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equationContinuity(sm::StellarModel, k::Int,
                   varm1::Matrix{TT}, var00::Matrix{TT}, varp1::Matrix{TT},
                   eosm1::EOSResults{TT}, eos00::EOSResults{TT}, eosp1::EOSResults{TT},
                   κm1::TT, κ00::TT, κp1::TT)::TT where {TT&lt;:Real}</code></pre><p>Default equation of mass continuity, evaluated for cell <code>k</code> of StellarModel <code>sm</code>.</p><p><strong>Arguments</strong></p><p>Identical to <a href="#Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>equationHSE</code></a> for compatibility with <a href="#Jems.Evolution.TypeStableEquation"><code>TypeStableEquation</code></a></p><p><strong>Returns</strong></p><p>Residual of comparing dr^3/dm with 3/(4πρ)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Equations.jl#L133-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.equationH1-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real" href="#Jems.Evolution.equationH1-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>Jems.Evolution.equationH1</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equationH1(sm::StellarModel, k::Int,
           varm1::Matrix{TT}, var00::Matrix{TT}, varp1::Matrix{TT},
           eosm1::EOSResults{TT}, eos00::EOSResults{TT}, eosp1::EOSResults{TT},
           κm1::TT, κ00::TT, κp1::TT)::TT where {TT&lt;:Real}</code></pre><p>Default equation of Hydrogen 1 evoluation, evaluated for cell <code>k</code> of StellarModel <code>sm</code>.</p><p><strong>Arguments</strong></p><p>Identical to <a href="#Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>equationHSE</code></a> for compatibility with <a href="#Jems.Evolution.TypeStableEquation"><code>TypeStableEquation</code></a></p><p><strong>Returns</strong></p><p>Residual of comparing dX_H1/dt with its computed reaction rate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Equations.jl#L174-L189">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real" href="#Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>Jems.Evolution.equationHSE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equationHSE(sm::StellarModel, k::Int,
            varm1::Matrix{TT}, var00::Matrix{TT}, varp1::Matrix{TT},
            eosm1::EOSResults{TT}, eos00::EOSResults{TT}, eosp1::EOSResults{TT},
            κm1::TT, κ00::TT, κp1::TT)::TT where {TT&lt;:Real}</code></pre><p>Default equation of hydrostatic equilibrium. Evaluates for cell <code>k</code> of StellarModel <code>sm</code> to what degree hydrostatic equilibrium is satisfied.</p><p><strong>Arguments</strong></p><ul><li><code>sm</code>: Stellar Model</li><li><code>k</code>: cell number to consider</li><li><code>varm1</code>: Matrix holding the dual numbers of the previous cell (<code>k-1</code>)</li><li><code>var00</code>: Matrix holding the dual numbers of this cell (<code>k</code>)</li><li><code>varp1</code>: Matrix holding the dual numbers of the next cell (<code>k+1</code>)</li><li><code>eosm1</code>: EOSResults object holding the results of the EOS evaluation of the previous cell (<code>k-1</code>)</li><li><code>eos00</code>: EOSResults object holding the results of the EOS evaluation of the current cell (<code>k</code>)</li><li><code>eosp1</code>: EOSResults object holding the results of the EOS evaluation of the next cell (<code>k+1</code>)</li><li><code>κm1</code>: Opacity evaluated at the previous cell (<code>k-1</code>)</li><li><code>κ00</code>: Opacity evaluated at the current cell (<code>k</code>)</li><li><code>κp1</code>: Opacity evaluated at the next cell (<code>k+1</code>)</li></ul><p><strong>Returns</strong></p><p>Residual of comparing dlnP/dm with -GM/4πr^4, where the latter is evaluated at the face of cell <code>k</code> and <code>k+1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Equations.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.equationHe4-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real" href="#Jems.Evolution.equationHe4-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>Jems.Evolution.equationHe4</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equationHe4(sm::StellarModel, k::Int,
           varm1::Matrix{TT}, var00::Matrix{TT}, varp1::Matrix{TT},
           eosm1::EOSResults{TT}, eos00::EOSResults{TT}, eosp1::EOSResults{TT},
           κm1::TT, κ00::TT, κp1::TT)::TT where {TT&lt;:Real}</code></pre><p>Default equation of Helium 4 evoluation, evaluated for cell <code>k</code> of StellarModel <code>sm</code>.</p><p><strong>Arguments</strong></p><p>Identical to <a href="#Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>equationHSE</code></a> for compatibility with <a href="#Jems.Evolution.TypeStableEquation"><code>TypeStableEquation</code></a></p><p><strong>Returns</strong></p><p>Residual of comparing He4 content with 1 minus the H1 content.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Equations.jl#L205-L220">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.equationLuminosity-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real" href="#Jems.Evolution.equationLuminosity-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>Jems.Evolution.equationLuminosity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equationLuminosity(sm::StellarModel, k::Int,
                   varm1::Matrix{TT}, var00::Matrix{TT}, varp1::Matrix{TT},
                   eosm1::EOSResults{TT}, eos00::EOSResults{TT}, eosp1::EOSResults{TT},
                   κm1::TT, κ00::TT, κp1::TT)::TT where {TT&lt;:Real}</code></pre><p>Default equation of energy generation, evaluated for cell <code>k</code> of StellarModel <code>sm</code>.</p><p><strong>Arguments</strong></p><p>Identical to <a href="#Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>equationHSE</code></a> for compatibility with <a href="#Jems.Evolution.TypeStableEquation"><code>TypeStableEquation</code></a></p><p><strong>Returns</strong></p><p>Residual of comparing dL/dm with ϵnuc - cₚ * dT/dt - (δ / ρ) * dP/dt</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Equations.jl#L97-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.equationT-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real" href="#Jems.Evolution.equationT-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>Jems.Evolution.equationT</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">equationT(sm::StellarModel, k::Int,
          varm1::Matrix{TT}, var00::Matrix{TT}, varp1::Matrix{TT},
          eosm1::EOSResults{TT}, eos00::EOSResults{TT}, eosp1::EOSResults{TT},
          κm1::TT, κ00::TT, κp1::TT)::TT where {TT&lt;:Real}</code></pre><p>Default equation of energy transport, evaluated for cell <code>k</code> of StellarModel <code>sm</code>.</p><p><strong>Arguments</strong></p><p>Identical to <a href="#Jems.Evolution.equationHSE-Union{Tuple{TT}, Tuple{Jems.Evolution.StellarModel, Int64, Matrix{TT}, Matrix{TT}, Matrix{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, Jems.EOS.EOSResults{TT}, TT, TT, TT}} where TT&lt;:Real"><code>equationHSE</code></a> for compatibility with <a href="#Jems.Evolution.TypeStableEquation"><code>TypeStableEquation</code></a></p><p><strong>Returns</strong></p><p>Residual of comparing dlnT/dm with -∇*GMT/4πr^4P, where the latter is evaluation at the face of cell <code>k</code> and <code>k+1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/Equations.jl#L48-L63">source</a></section></article><h2 id="Solver.jl"><a class="docs-heading-anchor" href="#Solver.jl">Solver.jl</a><a id="Solver.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Solver.jl" title="Permalink"></a></h2><h2 id="EvolutionLoop.jl"><a class="docs-heading-anchor" href="#EvolutionLoop.jl">EvolutionLoop.jl</a><a id="EvolutionLoop.jl-1"></a><a class="docs-heading-anchor-permalink" href="#EvolutionLoop.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.cycle_step_info!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.cycle_step_info!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.cycle_step_info!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cycle_step_info!(sm::StellarModel)</code></pre><p>Moves the model info of the StellarModel <code>sm</code> over one state: start step info -&gt; end step info -&gt; previous step info -&gt; start step info.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/EvolutionLoop.jl#L35-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.do_evolution_loop-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.do_evolution_loop-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.do_evolution_loop</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">do_evolution_loop(sm::StellarModel)</code></pre><p>Performs the main evolutionary loop of the input StellarModel <code>sm</code>. It continues taking steps until one of the termination criteria is reached (defined in <code>sm.opt.termination</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/EvolutionLoop.jl#L108-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.get_dt_next-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.get_dt_next-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.get_dt_next</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_dt_next(sm::StellarModel)</code></pre><p>Computes the timestep of the next evolutionary step to be taken by the StellarModel <code>sm</code> by considering all timestep controls (<code>sm.opt.timestep</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/EvolutionLoop.jl#L76-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.set_end_step_info!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.set_end_step_info!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.set_end_step_info!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_end_step_info(sm::StellarModel)</code></pre><p>Sets the end step info (sm.esi) from current state of the StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/EvolutionLoop.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.set_start_step_info!-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.set_start_step_info!-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.set_start_step_info!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_start_step_info!(sm::StellarModel)</code></pre><p>Sets the start step info of the StellarModel <code>sm</code> by copying from the previous step info.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/EvolutionLoop.jl#L48-L52">source</a></section></article><h2 id="InitialCondition.jl"><a class="docs-heading-anchor" href="#InitialCondition.jl">InitialCondition.jl</a><a id="InitialCondition.jl-1"></a><a class="docs-heading-anchor-permalink" href="#InitialCondition.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.get_logdq-Union{Tuple{TT}, Tuple{Int64, Int64, TT, TT, Int64}} where TT&lt;:Real" href="#Jems.Evolution.get_logdq-Union{Tuple{TT}, Tuple{Int64, Int64, TT, TT, Int64}} where TT&lt;:Real"><code>Jems.Evolution.get_logdq</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_logdq(k::Int, nz::Int, logdq_low::TT, logdq_high::TT, numregion::Int)::TT where {TT&lt;:Real}</code></pre><p>Computes the logarithm mass chunk <code>logdq</code> for zone <code>k</code> of a profile with total zones <code>nz</code>, while keeping in mind to better resolve the first and last <code>numregion</code> zones of the profile. It linearly interpolates the value from the inputs <code>logdq_low</code> and <code>logdq_high</code> in these regions, while keeping <code>logdq_high</code> in the middle zones.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/InitialCondition.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.n1_polytrope_initial_condition-Tuple{Jems.Evolution.StellarModel, Real, Real}" href="#Jems.Evolution.n1_polytrope_initial_condition-Tuple{Jems.Evolution.StellarModel, Real, Real}"><code>Jems.Evolution.n1_polytrope_initial_condition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">n1_polytrope_initial_condition(sm::StellarModel, M::Real, R::Real; initial_dt=100 * SECYEAR)</code></pre><p>Initializes a stellar model <code>sm</code> with values corresponding to an n=1 polytrope, setting the independent variables <code>sm.ind_vars</code>, etc. accordingly. Also sets the initial timestep to be taken, <code>initial_dt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/InitialCondition.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.θ_n-Tuple{Any}" href="#Jems.Evolution.θ_n-Tuple{Any}"><code>Jems.Evolution.θ_n</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">θ_n(ξ) = sin(ξ) / ξ, the sinc function</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/InitialCondition.jl#L5-L7">source</a></section></article><h2 id="IO.jl"><a class="docs-heading-anchor" href="#IO.jl">IO.jl</a><a id="IO.jl-1"></a><a class="docs-heading-anchor-permalink" href="#IO.jl" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.get_history_dataframe_from_hdf5-Tuple{Any}" href="#Jems.Evolution.get_history_dataframe_from_hdf5-Tuple{Any}"><code>Jems.Evolution.get_history_dataframe_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_history_dataframe_from_hdf5(hdf5_filename)</code></pre><p>Returns a DataFrame object built from an hdf5 file, named <code>hdf5_filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/IO.jl#L169-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.get_profile_dataframe_from_hdf5-Tuple{Any, Any}" href="#Jems.Evolution.get_profile_dataframe_from_hdf5-Tuple{Any, Any}"><code>Jems.Evolution.get_profile_dataframe_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_profile_dataframe_from_hdf5(hdf5_filename, profile_name)</code></pre><p>Returns a DataFrame object built from an hdf5 file, named <code>hdf5_filename</code>, considering the column named <code>profile_name</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/IO.jl#L191-L195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.get_profile_names_from_hdf5-Tuple{Any}" href="#Jems.Evolution.get_profile_names_from_hdf5-Tuple{Any}"><code>Jems.Evolution.get_profile_names_from_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_profile_names_from_hdf5(hdf5_filename)</code></pre><p>Retruns the column names of the profile data contained in the hdf5 file <code>hdf5_filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/IO.jl#L180-L184">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.history_get_ind_vars_edge_value-Tuple{Jems.Evolution.StellarModel, Symbol, Symbol}" href="#Jems.Evolution.history_get_ind_vars_edge_value-Tuple{Jems.Evolution.StellarModel, Symbol, Symbol}"><code>Jems.Evolution.history_get_ind_vars_edge_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">history_get_ind_vars_edge_value(sm::StellarModel, var_symbol::Symbol, edge::Symbol)</code></pre><p>Returns the value of the independent variable <code>var_symbol</code> at either the surface or the center of the StellarModel <code>sm</code>. <code>edge</code> can be either <code>:surface</code> or <code>:center</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/IO.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.profile_get_ind_vars_value-Tuple{Jems.Evolution.StellarModel, Symbol, Int64}" href="#Jems.Evolution.profile_get_ind_vars_value-Tuple{Jems.Evolution.StellarModel, Symbol, Int64}"><code>Jems.Evolution.profile_get_ind_vars_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">profile_get_ind_vars_value(sm::StellarModel, var_symbol::Symbol, k::Int)</code></pre><p>Returns the value of the variable Symbol <code>var_symbol</code> at cell number <code>k</code> of the StellarModel <code>sm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/IO.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jems.Evolution.write_data-Tuple{Jems.Evolution.StellarModel}" href="#Jems.Evolution.write_data-Tuple{Jems.Evolution.StellarModel}"><code>Jems.Evolution.write_data</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_data(dm::StellarModel)</code></pre><p>Saves data (history/profile) for the current model, as required by the settings in <code>sm.opt.io</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/orlox/Jems.jl/blob/dfac96412123cafcda0fa7656fd286dfcd82423d/src/Evolution/IO.jl#L76-L80">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../EOS/">« EOS</a><a class="docs-footer-nextpage" href="../Opacity/">Opacity »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 3 September 2023 04:00">Sunday 3 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
